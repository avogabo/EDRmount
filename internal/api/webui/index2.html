<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>EDRmount</title>
  <style>
    :root{
      --bg:#0b1020;
      --panel:#0f172a;
      --card:#0b1224;
      --text:#e7eefc;
      --muted:#9aa7c0;
      --line:rgba(255,255,255,.08);
      --btn:#111a33;
      --btnHover:#162247;
      --accent:#4f9cff;
      --danger:#ff5a6b;
      --ok:#22c55e;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial, sans-serif;
    }
    *{ box-sizing:border-box; }
    body{ margin:0; font-family:var(--sans); background:linear-gradient(180deg, var(--bg), #070b16); color:var(--text); }
    a{ color:inherit; text-decoration:none; }

    .app{ min-height:100vh; display:grid; grid-template-rows:56px 1fr; }
    header{
      display:flex; align-items:center; justify-content:space-between;
      padding:0 16px; border-bottom:1px solid var(--line);
      background:
        linear-gradient(90deg, rgba(11,16,32,.92), rgba(11,16,32,.72)),
        url('/webui/assets/banner.jpg');
      background-size: cover;
      background-position: center;
      backdrop-filter: blur(10px);
      position:sticky; top:0; z-index:10;
    }
    .brand{ display:flex; align-items:center; gap:10px; }
    .logoImg{ width:34px; height:34px; border-radius:10px; object-fit:cover; box-shadow: 0 0 0 1px rgba(255,255,255,.10) inset; }
    .brand b{ letter-spacing:.2px; }
    .hdrRight{ display:flex; align-items:center; gap:10px; color:var(--muted); font-size:13px; }

    .main{ display:grid; grid-template-columns:260px 1fr; gap:14px; padding:14px; }
    nav{
      background:rgba(15,23,42,.55);
      border:1px solid var(--line);
      border-radius:14px;
      padding:12px;
      height: calc(100vh - 56px - 28px);
      position:sticky; top:70px;
    }
    .navItem{
      display:flex; align-items:center; gap:10px;
      padding:10px 10px; border-radius:12px;
      color:var(--muted);
      cursor:pointer;
    }
    .navItem:hover{ background:rgba(255,255,255,.04); color:var(--text); }
    .navItem.active{ background:rgba(79,156,255,.15); color:var(--text); border:1px solid rgba(79,156,255,.25); }
    .navTitle{ font-size:13px; margin:8px 10px; color:var(--muted); text-transform:uppercase; letter-spacing:.12em; }

    .work{
      background:rgba(15,23,42,.35);
      border:1px solid var(--line);
      border-radius:14px;
      padding:16px;
      min-height:500px;
    }
    .row{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
    .btn{
      background:var(--btn);
      border:1px solid var(--line);
      color:var(--text);
      padding:9px 12px;
      border-radius:12px;
      cursor:pointer;
      font-size:14px;
    }
    .btn:hover{ background:var(--btnHover); }
    .btn.primary{ background:rgba(79,156,255,.18); border-color:rgba(79,156,255,.35); }
    .btn.danger{ background:rgba(255,90,107,.14); border-color:rgba(255,90,107,.25); }
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      color:var(--muted);
      font-size:13px;
    }
    .toggle{ display:inline-flex; border:1px solid var(--line); border-radius:999px; overflow:hidden; }
    .toggle button{ border:0; padding:8px 10px; background:transparent; color:var(--muted); cursor:pointer; }
    .toggle button.active{ background:rgba(79,156,255,.18); color:var(--text); }

    .crumbs{ font-family:var(--mono); color:var(--muted); font-size:13px; overflow:auto; white-space:nowrap; }
    .crumb{ display:inline-flex; align-items:center; gap:6px; padding:6px 10px; border-radius:999px; border:1px solid var(--line); background:rgba(255,255,255,.03); color:var(--text); cursor:pointer; }
    .crumb:hover{ background:rgba(255,255,255,.06); }
    .crumbSep{ opacity:.55; padding:0 6px; }

    .grid{ display:grid; grid-template-columns:1fr; gap:10px; margin-top:12px; }
    .list{
      border:1px solid var(--line);
      border-radius:14px;
      overflow:hidden;
      background:rgba(11,18,36,.55);
    }
    .listHeader, .listRow{
      display:grid;
      grid-template-columns: 1fr 110px 190px;
      gap:10px;
      padding:10px 12px;
      align-items:center;
    }
    .listHeader{ color:var(--muted); font-size:12px; border-bottom:1px solid var(--line); text-transform:uppercase; letter-spacing:.10em; }
    .listRow{ border-bottom:1px solid rgba(255,255,255,.06); cursor:pointer; }
    .listRow:hover{ background:rgba(255,255,255,.03); }
    .name{ display:flex; align-items:center; gap:10px; }
    .icon{ width:18px; height:18px; border-radius:6px; background:rgba(255,255,255,.06); display:inline-flex; align-items:center; justify-content:center; font-size:12px; color:var(--muted); }
    .mono{ font-family:var(--mono); }
    .muted{ color:var(--muted); }

    .sectionTitle{ font-size:16px; margin:0 0 10px 0; }
    .split{ display:flex; justify-content:space-between; align-items:center; gap:10px; }

    iframe{ width:100%; border:0; border-radius:14px; background:white; }
    .hide{ display:none !important; }

    @media (max-width: 860px){
      .main{ grid-template-columns:1fr; }
      nav{ position:relative; top:0; height:auto; }
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div class="brand">
        <img class="logoImg" src="/webui/assets/logo.jpg" alt="EDRmount" />
        <b>EDRmount</b>
      </div>
      <div class="hdrRight">
        <span class="pill" id="buildVersionPill">v1.65</span>
        <button class="btn" id="btnRestartTop">Reiniciar (Restart)</button>
      </div>
    </header>

    <div class="main">
      <nav>
        <div class="navTitle">Men√∫</div>
        <div class="navItem active" data-page="library">
          <div class="icon">üìö</div>
          <div>
            <div><b>Biblioteca</b></div>
            <div class="muted" style="font-size:12px">Explorador (Explorer)</div>
          </div>
        </div>
        <div class="navItem" data-page="upload">
          <div class="icon">‚¨Ü</div>
          <div>
            <div><b>Subida</b></div>
            <div class="muted" style="font-size:12px">Usenet upload</div>
          </div>
        </div>
        <div class="navItem" data-page="import">
          <div class="icon">üì•</div>
          <div>
            <div><b>Importar</b></div>
            <div class="muted" style="font-size:12px">NZB inbox</div>
          </div>
        </div>
        <div class="navItem" data-page="health">
          <div class="icon">ü©∫</div>
          <div>
            <div><b>Health</b></div>
            <div class="muted" style="font-size:12px">NZB repair</div>
          </div>
        </div>
        <div class="navItem" data-page="settings">
          <div class="icon">‚öô</div>
          <div>
            <div><b>Ajustes</b></div>
            <div class="muted" style="font-size:12px">Settings</div>
          </div>
        </div>
        <div class="navItem" data-page="logs">
          <div class="icon">üßæ</div>
          <div>
            <div><b>Logs</b></div>
            <div class="muted" style="font-size:12px">Jobs / activity</div>
          </div>
        </div>
      </nav>

      <div class="work">
        <!-- Library page -->
        <section id="page_library">
          <div class="split">
            <div>
              <h2 class="sectionTitle">Biblioteca (Library)</h2>
              <div class="muted">Vista de <b>library-auto</b> (FUSE). Toggle para manual.</div>
            </div>
            <div class="row">
              <div class="toggle" role="tablist" aria-label="Auto/Manual">
                <button id="tabAuto" class="active" type="button">Auto</button>
                <button id="tabManual" type="button">Manual</button>
              </div>
            </div>
          </div>

          <div id="autoPane">
                                    <div class="row" style="margin-top:10px">
              <div class="crumbs" id="autoCrumbs"></div>
              <button class="btn" id="btnAutoUp">Arriba (Up)</button>
              <button class="btn" id="btnAutoRefresh">Actualizar (Refresh)</button>
              <span class="muted" id="autoStatus"></span>
            </div>

            <div class="grid">
              <div class="list">
                <div class="listHeader" style="grid-template-columns: 1fr 110px 190px 70px;">
                  <div>Nombre (Name)</div>
                  <div class="mono">Size</div>
                  <div class="mono">ModTime</div>
                  <div>Acci√≥n</div>
                </div>
                <div id="autoList"></div>
              </div>
            </div>

            <div id="reviewBox" class="list" style="padding:12px; display:none">
              <div class="row" style="justify-content:space-between">
                <div>
                  <b>‚ö† Pendiente de revisi√≥n (Needs review)</b>
                  <div class="muted" style="margin-top:4px">Pel√≠culas donde el auto-match fall√≥. Corrige aqu√≠ y se reflejar√° en <b>library-auto</b> (para Plex).</div>
                </div>
                <button class="btn" id="btnReviewRefresh">Actualizar (Refresh)</button>
              </div>

              <div class="grid" style="margin-top:10px">
                <div class="list">
                  <div class="listHeader">
                    <div>Archivo (File)</div>
                    <div class="mono">Guess</div>
                    <div class="mono">Acci√≥n</div>
                  </div>
                  <div id="reviewList"></div>
                </div>
              </div>

              <div class="grid" style="margin-top:12px">
                <div class="list" style="padding:12px">
                  <div class="row">
                    <b>Corregir pel√≠cula (Fix movie)</b>
                    <span class="muted" id="fixSel">(selecciona un archivo arriba)</span>
                  </div>
                  <div class="row" style="margin-top:10px">
                    <label class="muted">T√≠tulo (Title)
                      <input id="fixTitle" style="min-width:260px; margin-left:8px" placeholder="Avatar" />
                    </label>
                    <label class="muted">A√±o (Year)
                      <input id="fixYear" type="number" style="width:110px; margin-left:8px" placeholder="2009" />
                    </label>
                    <label class="muted">Calidad (Quality)
                      <select id="fixQuality" style="min-width:140px; margin-left:8px">
                        <option value="1080">1080</option>
                        <option value="2160">2160 (4K)</option>
                        <option value="custom">Otro‚Ä¶ (custom)</option>
                      </select>
                    </label>
                    <label class="muted" id="fixQualityCustomWrap" style="display:none">Custom
                      <input id="fixQualityCustom" style="min-width:160px; margin-left:8px" placeholder="REMUX-2160" />
                    </label>
                    <label class="muted"><input type="checkbox" id="fixApplyAll" /> Aplicar a todo el NZB/import (Apply to all)</label>
                    <button class="btn primary" id="btnFixApply">Aplicar (Apply)</button>
                    <span class="muted" id="fixStatus"></span>
                  </div>
                </div>
              </div>
            </div>

          </div>

          <div id="manualPane" class="hide">
            <div class="split">
              <div>
                <div class="muted" style="margin:10px 0">Vista <b>Manual</b> (editable, DB-backed). (Manual view)</div>
              </div>
              <div class="row">
                <button class="btn" id="btnManUp">Arriba (Up)</button>
                <button class="btn" id="btnManRefresh">Actualizar (Refresh)</button>
                <span class="muted" id="manStatus"></span>
              </div>
            </div>

            <div class="row" style="margin-top:10px">
              <div class="crumbs" id="manCrumbs" style="flex:1"></div>
            </div>

            <div class="grid">
              <div class="list">
                <div class="listHeader" style="grid-template-columns: 1fr 110px 190px 70px;">
                  <div>Nombre (Name)</div>
                  <div class="mono">Size</div>
                  <div class="mono">ModTime</div>
                  <div>Acci√≥n</div>
                </div>
                <div id="manList"></div>
              </div>
            </div>
          </div>
        </section>

        <!-- Upload page placeholder -->
        <section id="page_upload" class="hide">
          <div class="split">
            <div>
              <h2 class="sectionTitle">Subida a Usenet (Upload)</h2>
              <div class="muted">Puedes subir un archivo al host y encolarlo para subida.</div>
            </div>
            <div class="row">
              <label class="muted">Subir media (Upload media)
                <input id="upUpload" type="file" style="margin-left:8px" />
              </label>
            </div>
          </div>

          <div class="grid2">
            <div class="card">
              <h3>Procesos activos (Active uploads)</h3>
              <div class="muted">Solo jobs de subida (upload).</div>
              <div class="muted" id="upActiveStatus"></div>
              <div id="upActive"></div>
            </div>

            <div class="card">
              <h3>√öltimas subidas (Recent uploads)</h3>
              <div class="muted" id="upRecentStatus"></div>
              <div id="upRecent"></div>
            </div>
          </div>
        </section>

        <!-- Import page placeholder -->
        <section id="page_import" class="hide">
          <div class="split">
            <div>
              <h2 class="sectionTitle">Importar (Import)</h2>
              <div class="muted">Explorador de <b>NZB inbox</b> (host) + importar a biblioteca.</div>
            </div>
            <div class="row">
              <button class="btn" id="btnImpUp">Arriba (Up)</button>
              <button class="btn" id="btnImpRefresh">Actualizar (Refresh)</button>
              <button class="btn primary" id="btnImpEnqueue" disabled>Importar seleccionado (Import selected)</button>
              <span class="muted" id="impStatus"></span>
            </div>
          </div>

          <div class="row" style="margin-top:10px">
            <div class="crumbs" id="impCrumbs" style="flex:1"></div>
          </div>

          <div class="grid">
            <div class="list">
              <div class="listHeader">
                <div>Nombre (Name)</div>
                <div class="mono">Size</div>
                <div class="mono">ModTime</div>
              </div>
              <div id="impList"></div>
            </div>
          </div>

          <div class="row" style="margin-top:12px">
            <label class="muted">Subir NZB (Upload NZB)
              <input id="impUpload" type="file" accept=".nzb" style="margin-left:8px" />
            </label>
          </div>

          <div class="muted" style="margin-top:10px" id="impSel">(ning√∫n NZB seleccionado)</div>
        </section>

        <!-- Health page -->
        <section id="page_health" class="hide">
          <div class="split">
            <div>
              <h2 class="sectionTitle">Health (NZB Repair)</h2>
              <div class="muted">Vista tipo Import, con estado health por NZB.</div>
            </div>
            <div class="row">
              <button class="btn" id="btnHealthUp">Arriba (Up)</button>
              <button class="btn" id="btnHealthRefresh">Actualizar (Refresh)</button>
              <button class="btn" id="btnHealthScan">Escanear ahora (Scan now)</button>
              <span class="muted" id="healthStatus"></span>
            </div>
          </div>

          <div class="row" style="margin-top:8px"><div class="crumbs" id="healthCrumbs" style="flex:1"></div></div>

          <div class="grid" style="margin-top:12px">
            <div class="list">
              <div id="healthSummary" class="muted" style="padding:10px 12px;border-bottom:1px solid #262626"></div>
              <div class="listHeader">
                <div>Nombre (Name)</div>
                <div class="mono">Size</div>
                <div class="mono">ModTime</div>
              </div>
              <div id="healthList"></div>
            </div>

            <div class="list" style="padding:12px">
              <b>Notas</b>
              <div class="muted" style="margin-top:6px">
                - La reparaci√≥n solo funciona si <b>health.enabled</b> est√° activo en Ajustes.<br/>
                - Los backups del NZB original se guardan en <span class="mono">/host/inbox/nzb/.health-bak</span>.
              </div>
            </div>
          </div>
        </section>

        <!-- Settings page placeholder -->
        <section id="page_settings" class="hide">
          <div class="split">
            <div>
              <h2 class="sectionTitle">Ajustes (Settings)</h2>
              <div class="muted">Configuraci√≥n principal del sistema.</div>
            </div>
            <div class="row">
              <button class="btn" id="btnSetReload">Recargar (Reload)</button>
              <button class="btn primary" id="btnSetSave">Guardar y reiniciar (Save & Restart)</button>
              <button class="btn danger" id="btnDBReset" title="Borra SOLO la base de datos (SQLite). Mantiene config.">Borrar BD (Reset DB)</button>
              <span class="muted" id="setStatus"></span>
            </div>
          </div>

          <div class="grid" style="margin-top:12px">
            <div class="list" style="padding:12px">
              <b>Subidas</b>
              <div class="muted" style="margin-top:6px">Control de subida de media: vigilancia, carpeta y NNTP de subida.</div>

              <div class="row" style="margin-top:12px">
                <label class="muted"><input type="checkbox" id="setWatchMediaEnabled" /> Vigilancia autom√°tica</label>
              </div>
              <div class="row" style="margin-top:8px">
                <label class="muted">Ruta carpeta vigilada
                  <input id="setWatchMediaDir" style="min-width:340px; margin-left:8px" placeholder="/host/inbox/media" />
                </label>
                <input type="checkbox" id="setWatchMediaRecursive" checked style="display:none" />
              </div>

              <div class="row" style="margin-top:14px">
                <b>Servidor Usenet (Upload NNTP - ngPost)</b>
              </div>
              <div class="row" style="margin-top:8px">
                <label class="muted">Host
                  <input id="setNntpHost" style="min-width:240px; margin-left:8px" placeholder="news.example.com" />
                </label>
                <label class="muted">Puerto (Port)
                  <input id="setNntpPort" type="number" style="width:110px; margin-left:8px" placeholder="563" />
                </label>
                <label class="muted"><input type="checkbox" id="setNntpSSL" checked /> SSL</label>
              </div>
              <div class="row" style="margin-top:8px">
                <label class="muted">Usuario (User)
                  <input id="setNntpUser" style="min-width:220px; margin-left:8px" />
                </label>
                <label class="muted">Password (Pass)
                  <input id="setNntpPass" type="password" style="min-width:220px; margin-left:8px" />
                </label>
              </div>
              <div class="row" style="margin-top:8px">
                <label class="muted">Conexiones (Connections)
                  <input id="setNntpConnections" type="number" style="width:110px; margin-left:8px" placeholder="20" />
                </label>
                <label class="muted">Hilos (Threads)
                  <input id="setNntpThreads" type="number" style="width:110px; margin-left:8px" placeholder="2" />
                </label>
                <label class="muted">Grupos (Groups)
                  <input id="setNntpGroups" style="min-width:340px; margin-left:8px" placeholder="alt.binaries.example" />
                </label>
              </div>

              <div class="muted" style="margin-top:12px">
                Nota: Guardar aplica cambios en config y reinicia el contenedor (Save writes config + restart).
              </div>
            </div>

            <div class="list" style="padding:12px">
              <b>Importaci√≥n</b>
              <div class="muted" style="margin-top:6px">Control del watcher NZB + datos NNTP de descarga (streaming/import).</div>

              <div class="row" style="margin-top:12px">
                <label class="muted"><input type="checkbox" id="setWatchNZBEnabled" /> Vigilancia autom√°tica</label>
              </div>
              <div class="row" style="margin-top:8px">
                <label class="muted">Ruta carpeta vigilada
                  <input id="setWatchNZBDir" style="min-width:340px; margin-left:8px" placeholder="/host/inbox/nzb" />
                </label>
                <input type="checkbox" id="setWatchNZBRecursive" checked style="display:none" />
              </div>

              <div class="row" style="margin-top:12px">
                <label class="muted"><input type="checkbox" id="setDL_ENABLED" /> Activar descarga (Enable)</label>
              </div>

              <div class="row" style="margin-top:8px">
                <label class="muted">Host
                  <input id="setDL_HOST" style="min-width:240px; margin-left:8px" placeholder="news.example.com" />
                </label>
                <label class="muted">Puerto (Port)
                  <input id="setDL_PORT" type="number" style="width:110px; margin-left:8px" placeholder="563" />
                </label>
                <label class="muted"><input type="checkbox" id="setDL_SSL" checked /> SSL</label>
              </div>

              <div class="row" style="margin-top:8px">
                <label class="muted">Usuario (User)
                  <input id="setDL_USER" style="min-width:220px; margin-left:8px" />
                </label>
                <label class="muted">Password (Pass)
                  <input id="setDL_PASS" type="password" style="min-width:220px; margin-left:8px" />
                </label>
              </div>

              <div class="row" style="margin-top:8px">
                <label class="muted">Conexiones (Connections)
                  <input id="setDL_CONN" type="number" style="width:110px; margin-left:8px" placeholder="20" />
                </label>
                <label class="muted">Prefetch segmentos (Prefetch)
                  <input id="setDL_PREFETCH" type="number" style="width:110px; margin-left:8px" placeholder="50" />
                </label>
              </div>
              <div id="dlStreamsHint" class="muted" style="margin-top:6px">Streams simult√°neos estimados: ~0</div>

              <div class="muted" style="margin-top:10px">Nota: se usa en los mounts FUSE al abrir/leer un archivo (Read triggers download).</div>
            </div>

            <div class="list" style="padding:12px">
              <b>Library auto</b>
              <div class="muted" style="margin-top:6px">Estructura de rutas virtuales que ve Plex (apunta Plex a <span class="mono">library-auto</span>).</div>

              <div class="row" style="margin-top:12px">
                <div class="muted"><b>library-auto</b> est√° siempre activo (no se puede desactivar).</div>
                <label class="muted" style="margin-left:14px"><input type="checkbox" id="setLibUpper" /> Carpetas en MAY√öSCULAS</label>
              </div>

              <div class="row" style="margin-top:12px">
                <div class="muted"><b>Templates actuales</b> (edita aqu√≠ y guarda):</div>
              </div>

              <div class="row" style="margin-top:10px">
                <div class="muted" style="min-width:120px"><b>Pelis</b></div>
              </div>
              <div class="row" style="margin-top:6px">
                <div class="muted" style="min-width:140px">Carpeta</div>
                <code id="tplMovieDir" class="mono" style="white-space:nowrap; overflow:auto; display:inline-block; max-width:740px"></code>
                <button class="btn" id="btnCopyMovieDir">Copiar</button>
              </div>
              <div class="row" style="margin-top:6px">
                <label class="muted" style="min-width:140px">Editar</label>
                <input id="setLibMovieDirT" style="min-width:740px" />
              </div>

              <div class="row" style="margin-top:10px">
                <div class="muted" style="min-width:140px">Archivo</div>
                <code id="tplMovieFile" class="mono" style="white-space:nowrap; overflow:auto; display:inline-block; max-width:740px"></code>
                <button class="btn" id="btnCopyMovieFile">Copiar</button>
              </div>
              <div class="row" style="margin-top:6px">
                <label class="muted" style="min-width:140px">Editar</label>
                <input id="setLibMovieFileT" style="min-width:740px" />
              </div>

              <div class="row" style="margin-top:12px">
                <div class="muted" style="min-width:120px"><b>Series</b></div>
              </div>
              <div class="row" style="margin-top:6px">
                <div class="muted" style="min-width:140px">Carpeta serie</div>
                <code id="tplSeriesDir" class="mono" style="white-space:nowrap; overflow:auto; display:inline-block; max-width:740px"></code>
                <button class="btn" id="btnCopySeriesDir">Copiar</button>
              </div>
              <div class="row" style="margin-top:6px">
                <label class="muted" style="min-width:140px">Editar</label>
                <input id="setLibSeriesDirT" style="min-width:740px" />
              </div>

              <div class="row" style="margin-top:10px">
                <div class="muted" style="min-width:140px">Carpeta temporada</div>
                <code id="tplSeasonDir" class="mono" style="white-space:nowrap; overflow:auto; display:inline-block; max-width:740px"></code>
                <button class="btn" id="btnCopySeasonDir">Copiar</button>
              </div>
              <div class="row" style="margin-top:6px">
                <label class="muted" style="min-width:140px">Editar</label>
                <input id="setLibSeasonT" style="min-width:740px" />
              </div>

              <div class="row" style="margin-top:10px">
                <div class="muted" style="min-width:140px">Archivo episodio</div>
                <code id="tplSeriesFile" class="mono" style="white-space:nowrap; overflow:auto; display:inline-block; max-width:740px"></code>
                <button class="btn" id="btnCopySeriesFile">Copiar</button>
              </div>
              <div class="row" style="margin-top:6px">
                <label class="muted" style="min-width:140px">Editar</label>
                <input id="setLibSeriesFileT" style="min-width:740px" />
              </div>

              <div class="row" style="margin-top:14px">
                <div class="muted"><b>Ejemplos reales</b> (preview)</div>
              </div>
              <div class="row" style="margin-top:6px">
                <code id="tplPrevMovie" class="mono" style="white-space:nowrap; overflow:auto; display:inline-block; max-width:980px"></code>
              </div>
              <div class="row" style="margin-top:6px">
                <code id="tplPrevSeries" class="mono" style="white-space:nowrap; overflow:auto; display:inline-block; max-width:980px"></code>
              </div>

              <div class="row" style="margin-top:14px">
                <div class="muted"><b>Variables disponibles</b></div>
              </div>
              <div class="muted" style="margin-top:6px; line-height:1.5">
                <span class="mono">{title}</span>, <span class="mono">{year}</span>, <span class="mono">{ext}</span>, <span class="mono">{tmdb_id}</span>,
                <span class="mono">{quality}</span>, <span class="mono">{initial}</span>,
                <span class="mono">{series}</span>, <span class="mono">{episode_title}</span>, <span class="mono">{series_status}</span>,
                <span class="mono">{season:00}</span>, <span class="mono">{episode:00}</span>,
                <span class="mono">{movies_root}</span>, <span class="mono">{series_root}</span>
              </div>
              <div class="muted" style="margin-top:6px">Tip: <span class="mono">:00</span> hace padding (01,02‚Ä¶).</div>

              <div class="row" style="margin-top:14px"><div class="muted"><b>TMDB</b></div></div>
              <div class="row" style="margin-top:8px">
                <label class="muted"><input type="checkbox" id="setTMDBEnabled" /> Activar TMDB (Enable)</label>
                <label class="muted">API Key
                  <input id="setTMDBApiKey" type="password" style="min-width:340px; margin-left:8px" placeholder="tmdb api key" />
                </label>
                <label class="muted">Idioma (Language)
                  <input id="setTMDBLanguage" style="min-width:160px; margin-left:8px" placeholder="es-ES" />
                </label>
              </div>

              <div class="row" style="margin-top:14px"><div class="muted"><b>FileBot</b> (auto rename)</div></div>
              <div class="row" style="margin-top:8px; gap:12px; flex-wrap:wrap">
                <div class="muted">License path fijo: <span class="mono">/config/filebot/license.psm</span></div>
                <button class="btn" id="btnFileBotTestLicense">Test licencia</button>
                <span class="muted" id="filebotTestStatus"></span>
              </div>
              <div class="row" style="margin-top:8px; gap:12px; flex-wrap:wrap">
                <label class="muted">DB
                  <input id="setFileBotDB" style="min-width:180px; margin-left:8px" placeholder="TheMovieDB" />
                </label>
                <label class="muted">Language
                  <input id="setFileBotLanguage" style="min-width:120px; margin-left:8px" placeholder="es" />
                </label>
              </div>
            </div>

            <div class="list" style="padding:12px">
              <b>Health (NZB Repair)</b>
              <div class="muted" style="margin-top:6px">Configuraci√≥n de escaneo/reparaci√≥n autom√°tica.</div>
              <div class="row" style="margin-top:12px">
                <label class="muted"><input type="checkbox" id="setHealthEnabled" /> Activar health</label>
                <label class="muted"><input type="checkbox" id="setHealthScanEnabled" /> Escaneo autom√°tico</label>
                <label class="muted"><input type="checkbox" id="setHealthAutoRepair" /> Reparaci√≥n autom√°tica</label>
              </div>
              <div class="row" style="margin-top:8px">
                <label class="muted">Presupuesto diario (min)
                  <input id="setHealthMaxDurationMins" type="number" style="width:110px; margin-left:8px" placeholder="180" />
                </label>
                <label class="muted">Reanudar cada (h)
                  <input id="setHealthChunkEveryHours" type="number" style="width:110px; margin-left:8px" placeholder="24" />
                </label>
                <label class="muted">Intervalo completo (h)
                  <input id="setHealthIntervalHours" type="number" style="width:110px; margin-left:8px" placeholder="24" />
                </label>
                <label class="muted">Lock TTL (h)
                  <input id="setHealthLockTTLHours" type="number" style="width:110px; margin-left:8px" placeholder="6" />
                </label>
              </div>
            </div>

            <div class="list" style="padding:12px">
              <b>Plex</b>
              <div class="muted" style="margin-top:6px">Refresco selectivo tras importar en library-auto.</div>
              <div class="row" style="margin-top:12px">
                <label class="muted"><input type="checkbox" id="setPlexAutoRefresh" /> Refrescar Plex autom√°ticamente al importar</label>
              </div>
              <div class="row" style="margin-top:8px">
                <label class="muted">URL
                  <input id="setPlexBaseURL" style="min-width:340px; margin-left:8px" placeholder="http://192.168.1.10:32400" />
                </label>
              </div>
              <div class="row" style="margin-top:8px">
                <label class="muted">Token
                  <input id="setPlexToken" type="password" style="min-width:340px; margin-left:8px" placeholder="X-Plex-Token" />
                </label>
              </div>
              <div class="row" style="margin-top:8px">
                <label class="muted">Plex root
                  <input id="setPlexRoot" style="min-width:340px; margin-left:8px" placeholder="/mnt/media/library-auto" />
                </label>
              </div>
            </div>

            <div class="list" style="padding:12px">
              <b>Backups</b>
              <div class="muted" style="margin-top:6px">Copia peri√≥dica de la base de datos y configuraci√≥n.</div>
              <div class="row" style="margin-top:12px">
                <label class="muted"><input type="checkbox" id="setBackupsEnabled" /> Activar backups</label>
                <label class="muted"><input type="checkbox" id="setBackupsCompress" /> Comprimir (.gz)</label>
              </div>
              <div class="row" style="margin-top:8px">
                <label class="muted">Directorio
                  <input id="setBackupsDir" style="min-width:280px; margin-left:8px" placeholder="/backups" />
                </label>
              </div>
              <div class="row" style="margin-top:8px">
                <label class="muted">Cada (min)
                  <input id="setBackupsEvery" type="number" style="width:110px; margin-left:8px" placeholder="0" />
                </label>
                <label class="muted">Mantener (n)
                  <input id="setBackupsKeep" type="number" style="width:110px; margin-left:8px" placeholder="30" />
                </label>
              </div>
              <div class="row" style="margin-top:10px">
                <button class="btn" id="setBackupsRun">Backup ahora</button>
                <button class="btn" id="setBackupsReload">Recargar lista</button>
              </div>
              <div class="row" style="margin-top:8px">
                <label class="muted">Restaurar backup
                  <select id="setBackupsRestoreName" style="min-width:360px; margin-left:8px"></select>
                </label>
                <button class="btn danger" id="setBackupsRestoreAll">Restaurar DB+config</button>
                <button class="btn danger" id="setBackupsRestoreDB">Solo DB</button>
                <button class="btn danger" id="setBackupsRestoreConfig">Solo config</button>
              </div>
              <div class="muted" id="setBackupsStatus" style="margin-top:8px"></div>
            </div>
          </div>
        </section>

        <!-- Logs page -->
        <section id="page_logs" class="hide">
          <div class="split">
            <div>
              <h2 class="sectionTitle">Logs</h2>
              <div class="muted">Logs de trabajos (jobs): import/upload/runner, etc.</div>
            </div>
            <div class="row">
              <button class="btn" id="btnLogsRefresh">Actualizar (Refresh)</button>
              <span class="muted" id="logsStatus"></span>
            </div>
          </div>

          <div class="grid" style="margin-top:12px; grid-template-columns: 1fr;">
            <div class="list">
              <div class="listHeader" style="grid-template-columns: 90px 120px 110px 1fr 110px;">
                <div>ID</div>
                <div>Tipo (Type)</div>
                <div>Estado (State)</div>
                <div>Ruta (Path)</div>
                <div>Acci√≥n</div>
              </div>
              <div id="logsJobs"></div>
            </div>

            <div class="list" style="padding:12px">
              <div class="row" style="justify-content:space-between">
                <div>
                  <b>Salida (Output)</b>
                  <div class="muted" style="margin-top:4px" id="logsTitle">Selecciona un job para ver sus logs.</div>
                </div>
                <label class="muted">L√≠neas (Lines)
                  <input id="logsLimit" type="number" style="width:110px; margin-left:8px" value="400" />
                </label>
              </div>
              <pre id="logsOut" class="mono" style="white-space:pre-wrap; margin:12px 0 0 0; max-height:55vh; overflow:auto;"></pre>
            </div>
          </div>
        </section>
      </div>
    </div>
  </div>

  <script src="/webui/app2.js"></script>
  <script src="/webui/upload2.js"></script>
</body>
</html>
